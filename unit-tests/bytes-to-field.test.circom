pragma circom 2.2.0;

include "../utils/bytes-to-field.circom";


template Main () {
  signal (test01, overflow01) <== BytesToFieldBE(1)([0]);
  test01 === 0;
  overflow01 === 0;

  signal (test02, overflow02) <== BytesToFieldBE(32)([
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0
  ]);
  test02 === 0;
  overflow02 === 0;

  signal (test03, overflow03) <== BytesToFieldBE(32)([
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 1
  ]);
  test03 === 1;
  overflow03 === 0;

  signal (test04, overflow04) <== BytesToFieldBE(32)([
    47, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0
  ]);
  test04 === 0x2f00000000000000000000000000000000000000000000000000000000000000;
  overflow04 === 0;

  signal (test05, overflow05) <== BytesToFieldBE(32)([
    48, 0, 0, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0
  ]);
  test05 === 0x3000000000000000000000000000000000000000000000000000000000000000;
  overflow05 === 0;

  signal (test05_o, overflow05_o) <== BytesToFieldBE(32)([
    49, 0, 0, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0
  ]);
  overflow05_o === 1;

  signal (test06, overflow06) <== BytesToFieldBE(32)([
    48, 100, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0
  ]);
  test06 === 0x3064000000000000000000000000000000000000000000000000000000000000;
  overflow06 === 0;

  signal (test06_o, overflow06_o) <== BytesToFieldBE(32)([
    48, 101, 0, 0, 0, 0, 0, 0, 0,
     0,   0, 0, 0, 0, 0, 0, 0, 0,
     0,   0, 0, 0, 0, 0, 0, 0, 0,
     0,   0, 0, 0, 0
  ]);
  overflow06_o === 1;


  signal (test07, overflow07) <== BytesToFieldBE(32)([
     48, 100,  78, 114, 225,  49, 160,  41,
    184,  80,  69, 182, 129, 129,  88,  93,
     40,  51, 232,  72, 121, 185, 112, 145,
     67, 225, 245, 147, 240,   0,   0,   0
  ]); // Al the same than p but last one
  test07 === 21888242871839275222246405745257275088548364400416034343698204186575808495616;
  overflow07 === 0;

  signal (test07_o, overflow07_o) <== BytesToFieldBE(32)([
      48, 100,  78, 114, 225,  49, 160,  41,
     184,  80,  69, 182, 129, 129,  88,  93,
      40,  51, 232,  72, 121, 185, 112, 145,
      67, 225, 245, 147, 240,   0,   0,   2
   ]);
  overflow07_o === 1;

  signal (test08, overflow08) <== BytesToFieldBE(32)([
      48, 100,  78, 114, 225,  49, 160,  41,
     184,  80,  69, 182, 129, 129,  88,  93,
      40,  51, 232,  72, 121, 185, 112, 145,
      67, 225, 245, 147, 240,   0,   0,   1
   ]);
  overflow08 === 1;


  signal (test09, overflow09) <== BytesToFieldBE(32)([
      48, 100,  78, 114, 225,  49, 160,  41,
     184,  80,  69, 182, 128, 129,  88,  93,
      40,  51, 232,  72, 121, 185, 112, 145,
      67, 225, 245, 147, 240,   0,   0,   1
   ]);

  test09 === 21888242871839275222246405745251566097777540560891801199820406206030277509121;
  overflow09 === 0;


  signal (test10_o, overflow10_o) <== BytesToFieldBE(32)([
      48, 100,  78, 114, 225,  49, 160,  41,
     184,  80,  69, 182, 129, 129,  88,  93,
      40,  51, 232,  73, 121, 185, 112, 145,
      67, 225, 245, 147, 240,   0,   0,   1
   ]);
  overflow10_o === 1;

  signal (test11_o, overflow11_o) <== BytesToFieldBE(32)([
    255, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0, 0, 0, 0, 0,
      0, 0, 0, 0, 0
  ]);
  overflow11_o === 1;

  signal (test12, overflow12) <== BytesToFieldBE(32)([
     20, 118,  72, 188, 133,  85,   2, 207,
    117,  96, 120,  89, 143, 130,  19,  30,
    176,  16,   1, 187,  71,  95,  59, 188,
    116, 160, 129, 228, 169, 131, 214, 205
  ]);
  test12 === 9255246933557625743145689864924057712882141895908641332005731506352640218829;
  overflow12 === 0;
}

component main = Main();
